<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Title</title>
    <!-- Bootstrap core CSS -->
    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/css/BsMultiSelect.css}" rel="stylesheet">

    <script type="text/javascript" th:src="@{/js/jquery-3.2.1.slim.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/popper.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/bootstrap.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/BsMultiSelect.js}"></script>
    <!-- (Optional) Latest compiled and minified JavaScript translation files -->
    <!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/js/i18n/defaults-*.min.js"></script>-->

</head>
<body>
<main role="main" class="col-md-12 ml-sm-auto align-self-center col-lg-8 pt-3 px-4">
    <form th:action="@{/query}" method="post">
        <div id="inputs">
            <div id="crane">
                <h2>
                    <button id="addC" type="button" class="btn btn-success">添加Crane</button>
                    <button id="removeC" type="button" class="btn btn-danger">删除Crane</button>
                </h2>
                <div class="row">
                    <p>Crane_1-1</p>
                    <div class="col-md-6">
                        <label class="form-inline">类别&nbsp;&nbsp;
                            <input type="text" class="form-control" form-control-sm name="cranes[0].type"
                                   placeholder="可以执行任务的类别">
                        </label>
                    </div>
                </div>
            </div>
            <div id="task">
                <div class="row">
                    <div class="col-md-12">
                        <div>
                            <label class="form-inline"/>倒剁任务(0)
                            <input type="text" class="form-control" form-control-sm name="tasks[0].num"
                                   placeholder="数量" value="0">
                            <input type="hidden" name="tasks[0].type" value="0">
                        </div>
                        <div>
                            <label class="form-inline"/>开始位置
                            <select name="tasks[0].begin" id="begin1" class="form-control" multiple="multiple"
                                    style="display: none;">
                            </select>
                        </div>
                        <div>
                            <label class="form-inline"/>结束位置
                            <select name="tasks[0].end" id="end1" class="form-control" multiple="multiple"
                                    style="display: none;"></select>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div>
                            <label class="form-inline"/>出入库任务(1)
                            <input type="text" class="form-control" form-control-sm name="tasks[1].num"
                                   placeholder="数量" value="0">
                            <input type="hidden" name="tasks[1].type" value="1">
                        </div>
                        <div class="col-md-8">
                            <label class="form-inline"/>开始位置
                            <select name="tasks[1].begin" id="begin2" class="form-control" multiple="multiple"
                                    style="display: none;">
                            </select>
                        </div>
                        <div class="col-md-8">
                            <label class="form-inline"/>结束位置
                            <select name="tasks[1].end" id="end2" class="form-control" multiple="multiple"
                                    style="display: none;">
                            </select>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div>
                            <label class="form-inline"/>机组任务(2)
                            <input type="hidden" name="tasks[2].type" value="2">
                            <input type="text" class="form-control" form-control-sm name="tasks[2].num"
                                   placeholder="数量" value="0">
                        </div>
                        <div class="col-md-8">
                            <label class="form-inline"/>开始位置
                            <select name="tasks[2].begin" id="begin3" class="form-control" multiple="multiple"
                                    style="display: none;">
                            </select>
                        </div>
                        <div class="col-md-8">
                            <label class="form-inline"/>结束位置
                            <select name="tasks[2].end" id="end3" class="form-control" multiple="multiple"
                                    style="display: none;">
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 offset-md-1">
            <select class="form-control" name="algorithmType"
                    style="text-align:center;text-align-last:center;padding-left:5px; margin:-0rem 0;">
                <option th:value="0" th:text="模拟退火"></option>
                <option th:value="1" th:text="遗传算法"></option>
                <option th:value="2" th:text="蚁群算法"></option>
            </select>
        </div>
        <div class="form-group" style="margin-top: 10px">
            <div class="col-md-6 offset-md-2">
                <button type="submit" class="btn btn-default">计算</button>
            </div>
        </div>
    </form>
</main>
<script th:inline="javascript">
    let options = [[${options}]]
    let selectBlock = $(".row select")
    for (idx in options) {
        if (idx === "0") {
            selectBlock.append(`
        <option value="` + idx + `" selected>` + options[idx] + `</option>
        `)
        } else {
            selectBlock.append(`
        <option value="` + idx + `">` + options[idx] + `</option>
        `)
        }

    }
    selectBlock.bsMultiSelect();


    // 添加删除crane
    let cI = 1;

    function addCrane() {
        if (cI > 2) {
            alert("最多支持三台行车模拟！！！")
            return
        }
        $("#crane").append(`
        <div class="row">
            <p>` + ((cI == 1) ? 'Crane_1-2' : 'Crane_1-3') + `</p>
            <div class="col-md-6">
                <label class="form-inline">类别&nbsp;&nbsp;
                    <input type="text" class="form-control" form-control-sm name="cranes[` + cI + `].type" placeholder="可以执行任务的类别">
                </label>
            </div>
        </div>
        `)
        ++cI
    }

    $("#addC").click(addCrane)

    $("#removeC").click(() => {
        if (cI < 2) {
            alert("不能再少了！")
            return
        }
        $("#inputs #crane .row").last().remove()
        --cI
    })
</script>
</body>
</html>